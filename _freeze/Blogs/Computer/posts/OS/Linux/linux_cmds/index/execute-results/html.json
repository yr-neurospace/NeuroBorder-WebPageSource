{
  "hash": "50332aa7dfbcf2e41a3429c61f4c36a2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Commonly used Linux commands\"\nauthor: \"Rui Yang\"\ndate: \"2024-12-19\"\ndate-modified: last-modified\ncategories: [linux, command]\nformat:\n  html:\n    toc: true\n    toc-depth: 6\n    toc-location: left\n    fig-align: center\n    number-depth: 6\n    number-sections: true\n    fig-cap-location: bottom\n    fig-format: png\n    lightbox: true\n    tbl-cap-location: top\n    page-layout: full\n\nexecute:\n  eval: false\n  warning: false\n---\n\n\n\n\n## 系统资源监控\n\n1. Comprehensive statistics\n\n- `btop`: CPU, GPU, Mem, Disk (I/O), Net.\n\n- `htop`: CPU, Mem.\n\n- `top`: CPU, Mem.\n\n2. GPU\n\n- NVIDIA\n\n  * `nvitop -m full --colorful --gpu-util-thresh 10 80 --mem-util-thresh 10 80`\n\n  * `nvidia-smi`\n\n3. Disk I/O\n\n- `iostat`\n\n4. CPU  temperatures\n\n- From `lm-sensors`: `sensors`\n\n5. Network\n\n- Total statistics: `nload`\n\n- Statistics per process: `nethogs`\n\n6. Disk usage\n\n- Total statistics: `df -h`\n\n- For given directories/files: `du -sh`\n\n## 用户管理\n\n\n\n\n```{bash}\n# create a normal user\nsudo adduser yangrui\n\n# set the password for an user\nsudo passwd yangrui\n\n# modify your own password\npasswd\n\n# add an user to the sudo group (administrator) without removing it from other groups\nsudo usermod -aG sudo yangrui\n\n# delete an user and its home directory\nsudo deluser --remove-home yangrui\n\n# view an user's info\nid yangrui\n\n# login as a given user\nsu - yangrui\n```\n\n\n\n\n## 内核相关命令\n\n\n\n\n```{bash}\n# 查看当前正在使用的内核版本\nuname -r\n\n# 查看所有已安装的内核版本\ndpkg --list | grep linux\ndpkg --get-selections | grep linux\n\n# 固定内核版本\nsudo apt-mark hold linux-image-$(uname -r)\nsudo apt-mark hold linux-headers-$(uname -r)\nsudo apt-mark hold linux-modules-$(uname -r)\nsudo apt-mark hold linux-modules-extra-$(uname -r)\nsudo apt-mark hold linux-generic\nsudo apt-mark hold linux-image-generic\nsudo apt-mark hold linux-headers-generic\nsudo apt-mark hold linux-libc-dev:amd64\n\n# 恢复内核更新\nsudo apt-mark unhold linux-image-$(uname -r)\nsudo apt-mark unhold linux-headers-$(uname -r)\nsudo apt-mark unhold linux-modules-$(uname -r)\nsudo apt-mark unhold linux-modules-extra-$(uname -r)\nsudo apt-mark unhold linux-generic\nsudo apt-mark unhold linux-image-generic\nsudo apt-mark unhold linux-headers-generic\nsudo apt-mark unhold linux-libc-dev:amd64\n```\n\n\n\n\n## 文件权限与归属\n\n### 基本文件权限\n\n1. 基本文件权限的字符及其数字表示\n\n![Basic file permisions](./figures/basic_file_permissions.png){.lightbox fig-alt=\"Click to see a larger version of the image\" fig-align=\"center\"}\n\n2. `r`、`w` 和 `x` 权限对于文件和目录的区别\n\n![Meanings of basic file permissions for files and directories](./figures/meanings_of_basic_file_permissions_for_files_and_directories.png){.lightbox fig-alt=\"Click to see a larger version of the image\" fig-align=\"center\"}\n\n### 特殊文件权限\n\n1. SUID\n\nSUID 是一种对二进制程序进行设置的权限，能够让二进制程序的执行者**临时**拥有**所有者**的权限，**执行者应首先拥有二进制程序的执行权限**。如果一个文件被赋予了 SUID 权限且其所有者拥有执行权限，则其所有者的 `x` 权限位变为 `s`，否则变为 `S`。\n\n设置/取消 SUID 权限：`u+s`/`u-s`。\n\n2. SGID\n\n- 对**二进制程序**进行设置时，能够让执行者**临时**拥有文件**所属组**的权限，执行者同样应首先拥有二进制程序的执行权限。\n\n- 对**目录**进行设置时，则是让该目录内新创建的文件自动继承该目录的所属组。\n\n如果一个文件或目录被赋予了 SGID 权限且其所属组拥有执行权限，则其所属组的 `x` 权限位变为 `s`，否则变为 `S`。\n\n设置/取消 SGID 权限：`g+s`/`g-s`。\n\n3. SBIT\n\n当某个目录被设置了 SBIT 权限后，该目录下的文件只可被其**所有者**删除。\n\n如果一个目录被赋予了 SBIT 权限且**其他用户**拥有执行权限，则**其他用户**的 `x` 权限位变为 `t`，否则变为 `T`。\n\n设置/取消 SBIT 权限：`o+t`/`o-t`。\n\n对于数字表示法：SUID/SGID/SBIT 分别对应 4/2/1。\n\n完整的数字表示法是：特殊权限 + 一般权限。例如：`7777` 是最大权限，其第一位代表特殊权限位。\n\n### 修改文件权限\n\n\n\n\n```{bash}\n# 对目录进行递归操作加 -R\n# 数字表示法\nchmod 755 test\n\n# 字符表示法\nchmod o+x test\n```\n\n\n\n\n### 修改文件所属\n\n\n\n\n```{bash}\n# 对目录进行递归操作加 -R\n# 设置文件的所有者和所属组\nchown owner:group test\n```\n\n\n\n\n## 文件的隐藏属性\n\n可以使用 `chattr` 和 `lsattr` 来设置或查看文件的隐藏属性。\n\n## 文件访问控制列表（ACL）\n\n利用 ACL 可以针对特定的用户或用户组设置文件的权限。\n\n可以利用 `setfacl` 和 `getfacl` 来设置或查看文件的 ACL 权限。\n\n如果一个文件设置了 ACL 权限，则其权限位最后一个 `.` 就会变成 `+`。\n\n\n\n\n```{bash}\nsetfacl -mR u:yangrui:rwx /root\n\ngetfacl /root\n```\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}