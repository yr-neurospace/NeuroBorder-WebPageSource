{
  "hash": "4c71e8ac2819300d9c53536182df2658",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Lorenz curve and Gini index\"\nauthor: \"Rui Yang\"\ndate: \"2024-09-15\"\ndate-modified: last-modified\ncategories: [lorenz curve, gini index]\nformat:\n  html:\n    toc: true\n    toc-depth: 6\n    toc-location: left\n    fig-align: center\n    number-depth: 6\n    number-sections: true\n    fig-cap-location: bottom\n    fig-format: png\n    lightbox: true\n    tbl-cap-location: top\n    page-layout: full\n\nexecute:\n  warning: false\n\njupyter: julia-1.10\n---\n\n\n## Lorenz curve\n\n#### Introduction and explanation\n\nIn economics, the **Lorenz curve** is a graphical representation of the distribution of income or of wealth.\n\nThe curve is a graph showing **the proportion of overall income or wealth** assumed by **the bottom** $\\mathbf{x\\%}$ **of the people**. It is often used to represent income distribution, where it shows for the bottom $x\\%$ of households, what percentage $y\\%$ of the total income they have.\n\n![A typical Lorenz curve](./figures/a_lorenz_curve_scheme.png){.lightbox fig-alt=\"Click to see a larger version of the image\" fig-align=\"center\"}\n\nA perfectly equal income distribution would be in which everyone has the same income. In this case, the bottom $N\\%$ of society would always have $N\\%$ of the income. This can be depicted by the straight line $y = x$, called the \"**line of perfect equality**\".\n\nBy contrast, a perfectly unequal distribution would be one in which one person has all the income and everyone else has none. In that case, the curve would be at $y = 0\\%$ for all $x < 100\\%$, and $y = 100\\%$ when $x = 100\\%$. This curve is called the \"**line of perfect inequality**\".\n\n#### Definition and calculation\n\nThe Lorenz curve can usually be represented by a function $L(F)$, where $F$, the cumulative portion of the population, is represented by the horizontal axis, and $L$, the cumulative portion of the total wealth or income, is represented by the vertical axis.\n\nThe curve $L$ need not be a smoothly increasing function of $F$. For wealth distributions there may be oligarchies or people with negative wealth for instance.\n\n1. Discrete distribution\n\nFor a discrete distribution of $Y$ given by values $y_1, ..., y_n$ in **non-decresing** order ($y_i \\le y_{i+1}$) and their probabilities $f(y_i) := Pr(Y = y_i)$, the Lorenz curve is a continuous piecewise linear function connecting the points $(F_i, L_i)$ for $i=1$ to $n$, where $F_0 = 0, L_0 = 0$.\n\n$$\n\\begin{align}\nF_i &:= \\sum_{j=1}^{i} f(y_j) \\\\\nS_i &:= \\sum_{j=1}^{i} y_i f(y_i) \\\\\nS &:= \\sum_{i=1}^{n} y_i f(y_i) \\\\\nL_i &:= \\frac{S_i}{S}\n\\end{align}\n$$\n\n2. Continuous distribution\n\nFor a continuous distribution with the PDF $f$ and the CDF $F$, the Lorenz curve $L$ is given by\n\n$$\nL(F(x)) = \\frac{\\int_{-\\infty}^{x} t f(t) dt}{\\int_{-\\infty}^\\infty t f(t) dt} = \\frac{\\int_{-\\infty}^{x} t f(t) dt}{\\mu}\n$$\n\nwhere $\\mu$ denotes the average.\n\nThe Lorenz curve $L(F)$ may then be plotted as a function parametric in $x$: $L(x) \\text{ vs. } F(x)$.\n\n## Gini index\n\n### Definition\n\nThe Gini coefficient is the ratio of **the area between the line of perfect equality and the observed Lorenz curve** to **the area between the line of pefect equality and the line of perfect inequality**. The higher the coefficient, the more unequal the distribution. In the diagram above, this is given by the ratio $\\frac{A}{A+B} = 2A = 1-2B$ due to the fact that $A + B = 0.5$.\n\nAssuming **non-negative** income or wealth for all, the Gini coefficient's theoretical range is from $0$ (total equality) to $1$ (absolute inequality).\n\nAn alternative approach is to define the Gini coefficient as **half of the relative mean absolute difference**, which is equivalent to the definition based on the Lorenz curve. The mean absolute difference is the average absolute difference of all pairs of items of the population, and the relative mean absolute difference is the mean absolute difference divided by the average $\\bar{x}$ to normalize for scale.\n\nIf $x_i$ is the income or wealth of person $i$, and there are $n$ persons, then the Gini coefficient $G$ is given by\n\n$$\nG = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{n} |x_i - x_j|}{2n^2\\bar{x}} = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{n} |x_i - x_j|}{2n \\sum_{i=1}^{n} \\bar{x}}\n$$\n\nWhen the wealth or income distribution is given as a continuous PDF $p(x)$, the Gini coefficient is again half of the relative mean absolute difference:\n\n$$\nG = \\frac{1}{2\\mu} \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} p(x)p(y) |x-y| dxdy\n$$\n\nwhere $\\mu = \\int_{-\\infty}^{\\infty} xp(x) dx$ is the mean of the distribution, and the lower limits of integration may be replaced by zero when all incomes are positive.\n\n### Calculation\n\nIf the values are first placed **in ascending order**, such that each $x$ has rank $i$, some of the comparisons above can be avoided and the computation can be quicker:\n\n$$\n\\begin{align}\nG &= \\frac{2}{n^2\\bar{x}} \\sum_{i=1}^{n} i(x_i - \\bar{x}) \\\\\nG &= \\frac{\\sum_{i=1}^{n} (2i-n-1)x_i}{n \\sum_{i=1}^{n} x_i}\n\\end{align}\n$$\n\nwhere $x$ is an observed value, $n$ is the number of values observed and $i$ is the rank of values in ascending order.\n\n**Note that only positive non-zero values are used.**\n\n1. Julia code\n\n::: {#49dcedfd .cell execution_count=1}\n``` {.julia .cell-code}\nusing Random, Distributions\n\nRandom.seed!(1234)\n\n@doc raw\"\"\"\n    gini(A::AbstractArray)\n\nCalculate the Gini coefficient of an array of numbers using the formula:\n\n``G = \\frac{\\sum_{i=1}^{n} (2i-n-1)x_i}{n \\sum_{i=1}^{n} x_i}``\n\"\"\"\nfunction gini(A::AbstractArray)\n    A = vec(A)\n\n    # values cannot be negative\n    if minimum(A) < 0\n        A = A .- minimum(A)\n    end\n    # values cannot be 0\n    A = A .+ 1e-7\n\n    A = sort(A)\n    n = length(A)\n    index = collect(1:n)\n\n    sum(@. (2 * index - n - 1) * A) / (n * sum(A))\nend\n\n\nA = zeros(1000)\nA[1] = 1\nprintln(gini(A))\n\nB = ones(1000)\nprintln(gini(B))\n\nC = rand(Normal(0, 10), 1000)\nprintln(gini(C))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.998900109989001\n-1.0004440719058136e-17\n0.1756229561649242\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}